"use strict";const inputElement=document.querySelector(".js-input"),buttonElement=document.querySelector(".js-button"),formElement=document.querySelector(".js-form"),ulSeriesList=document.querySelector(".js-seriesList"),favListElement=document.querySelector(".js-favList");let seriesList=[],favouriteSeries=[];function getDataFromApi(){getFromLocalStorage();const e=inputElement.value;fetch("http://api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{seriesList=[];for(let s=0;s<e.length;s++){const t=e[s].show;seriesList.push(t)}renderSeries()})}function handleForm(e){e.preventDefault()}function renderSeries(){let e="";for(const s of seriesList){let t;isFavSeries(s)?(t="favourite",console.log("found a favourite")):(t="",console.log("found a not favourite")),e+=`<li class='js-series ${t}' id="${s.id}">`,e+=`<h2 class='js-seriesTitle''>${s.name}</h2>`;const i=s.image;e+=null===i?'<img class="sectionSeries__list--img" src="../assets/images/download (1).png">':`<img class="sectionSeries__list--img" src=${i.medium}>`,e+="</li>"}ulSeriesList.innerHTML=e,listenToCardsEvent()}function isFavSeries(e){return void 0!==favouriteSeries.find(s=>s.id===e.id)||(console.log(e.id),!1)}function listenToCardsEvent(){const e=document.querySelectorAll(".js-series");for(const s of e)s.addEventListener("click",handleCard)}function handleCard(e){const s=parseInt(e.currentTarget.id),t=seriesList.find(e=>e.id===s),i=favouriteSeries.findIndex(e=>e.id===s);-1===i?favouriteSeries.push(t):favouriteSeries.splice(i,1),setInLocalStorage(),renderFavourites(),renderSeries()}function renderFavourites(){let e="";for(const s of favouriteSeries){e+=`<li class='js-series'id="${s.id}">`,e+=`<h2 class='js-seriesTitle''>${s.name}</h2>`;const t=s.image;e+=null===t?'<img class="sectionSeries__list--img" src="../assets/images/download (1).png">':`<img class="sectionSeries__list--img" src=${t.medium}>`,e+="</li>"}favListElement.innerHTML=e}function setInLocalStorage(){const e=JSON.stringify(favouriteSeries);localStorage.setItem("favouriteSeries",e)}function getFromLocalStorage(){const e=localStorage.getItem("favouriteSeries");if(null!==e){const s=JSON.parse(e);favouriteSeries=s,renderFavourites()}}buttonElement.addEventListener("click",getDataFromApi),formElement.addEventListener("submit",handleForm),getFromLocalStorage();